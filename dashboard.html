<!-- User's main page. Links to all other pages -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puzzle Betting System - Dashboard</title>
</head.
<body>
    <header>
        <h1>Welcome to Your Dashboard</h1>
        <!-- Webpage navigation links-->
        <nav>
            <ul>
                <li><a href="account_mgmt.html">Manage Account</a></li>
                <li><a href="home.html">Race Results</a></li> <!-- get rid of me!! -->
            </ul>
        </nav>
    </header>

    <main>
        <section class="user-info">
            <h2>Dashboard</h2>
            <!-- Display user's username and chip balance -->
            <p>Welcome, <span id="username">JohnDoe</span>! Your current chip balance is <span id="chip-balance">500</span>.</p>
            <!-- Link to upgrade to premium membership -->
            <p>Upgrade to premium <a href="upgrade.html">here</a> for access to all race results.</p>
        </section>
        <section class="betting-options">
            <h2>Upcoming Races</h2>
            <!-- Display upcoming races with options to place bets -->
            <table id="table">
            <tr>
                <th><h3>Tire Brand</h3></th>
                <th><h3>Tire Type</h3></th>
                <th><h3>Color</h3></th>
                <th><h3>Body Type</h3></th>
            </tr>
            </table>
        <script>
            const timer = document.getElementById('timer');
            const table = document.getElementById('table');
        
            function updateTable() {
                fetch('./getCars', {
                    method: 'POST'
                }).then(response => response.json()).then(data => {
                    
                    var table = document.getElementById("table");
                    for(var i = 0; i < 10; i++) {
                        var newRow = table.insertRow();
                        newRow.style.color = data[i].ColorHex;
                        newRow.insertCell().innerHTML = data[i].tireBrand;
                        newRow.insertCell().innerHTML = data[i].tireType;
                        newRow.insertCell().innerHTML = data[i].colorStr;
                        newRow.insertCell().innerHTML = data[i].body;
                    }
                    
                });
            }
        
            function updateClock() {
                var currTime = new Date();
                if(currTime.getSeconds() > 50) {
                    timer.innerText = (2 - currTime.getMinutes()%3) + ":0" + (60 - currTime.getSeconds());
                } else if(currTime.getSeconds() == 0) {
                    timer.innerText = (3 - currTime.getMinutes()%3) + ":00";
                } else {
                    timer.innerText = (2 - currTime.getMinutes()%3) + ":" + (60 - currTime.getSeconds());
                }
                if(currTime.getSeconds() == 1 && currTime.getMinutes()%3 == 0) {
                    for(var i = 0; i < 10; i++) {
                        table.deleteRow(-1);
                    }
                    updateTable();
                    console.log("Updated");
                    setTimeout(() => {updateClock();}, 1000);
                } else {
                    setTimeout(() => {updateClock();}, 100);
                }
                
            }
        
            updateTable();
            updateClock();
        </script>
            <!-- More upcoming races can be listed here -->
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Puzzle Betting System. All rights reserved.</p>
    </footer>
</body>
</html>
